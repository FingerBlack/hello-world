# C与C++的区别和联系

## C语言

### C的起源

一般来说，计算机语言需要对数据和算法这两个部分进行处理。数据是程序使用和处理的信息，而算法是程序使用的方法。

早期的计算机存储器容量非常小，人们设计程序时首先考虑的问题是如何减少存储器开销，硬件的限制不容许人们考虑如何组织数据与逻辑。而随着大容量存储器的出现以及计算机技术的广泛应用，程序编写越来越困难，程序的大小以算术级数递增，程序的逻辑控制难度则以几何级数递增，人们不得不考虑程序设计的方法。到了20世纪70年代早期，贝尔实验室的Dennis Ritchie 在开发UNIX操作系统时，需要有一种简洁的、能高效地控制硬件的语言。传统上，程序员使用汇编语言来满足这些需求，汇编语言依赖于计算机的内部机器语言。然而，汇编语言是低级语言，即直接操作硬件，如直接访问CPU寄存器和内存单元。因此汇编语言针对于特定的计算机处理器，要将汇编程序移植到另一种计算机上，必须使用不同的汇编语言重新编写程序。因而，Ritchie需要一种高级语言来达到他的目标，于是他在B语言的基础上开发了C语言。

对C语言来说，它在最初面世时被定义为是过程性语言，这就意味着它所强调的是算法与数据结构方面。从概念上说，过程性语言的编程首先要确定计算机应采取的操作，然后使用编程语言来实现这些操作。所编写的程序来命令计算机进行这一系列流程从而实现特定的任务或得到特定结果。

随着程序规模的扩大，早期的程序语言（如 Fortran 和 BASIC ）都会遇到组织方面的问题。例如，程序经常使用分支语句，根据某种测试的结果，执行一组或另一组指令。这种结构的可读性非常差，几乎无法通过阅读去理解。为了解决这种问题，计算机科学家开发了一种更有序的编程方法——结构化编程。C语言便具有使用这种方法的特性。结构化方法是一种传统的程序设计方法，它是由结构化分析、结构化设计和结构化编码三部分有机组合而成的。它的基本思想是把一个复杂问题的求解过程分阶段进行，使得每个阶段处理的问题都控制在人们容易理解和处理的范围内。而这种方法遵循的原则是「自顶向下」，其理念是将大型程序分解成小型、便于管理的任务。如果其中的一项任务仍然过大，则将它分解为更小的任务。这一过程将一直持续下去，直到将程序划分为小型的、易于编写的模块。

从编程技术的角度来说，结构化方法在进行程序设计时，描述任何实体的操作序列只需采用“顺序、选择、重复”三种基本控制结构，整个程序划分为若干个模块。每个模块要具有一种以上的特定功能，并且每个模块只能有一个入口和一个出口。这种程序设计采用自顶向下、逐步细分的方法展开，在一定的数据结构基础上设计对应的算法，然后分别实现数据结构设计和算法设计，因此N.With教授总结出「**程序＝算法＋数据结构**」。在结构化程序设计中，问题被看成一系列需要完成的任务，函数或过程则是用于完成这些任务的。所以说，最终解决问题的焦点集中于函数或过程，数据则在功能模块间流动。C语言的设计有助于使用这种方法，它鼓励程序员开发程序单元（函数）来表示各个任务模块。如上所述，结构化编程技术反映了过程性编程的思想，根据执行的操作来构思一个程序。

目前，C语言编译器普遍存在于各种不同的操作系统中，例如 Microsoft Windows、macOS、Linux、Unix 等。C语言的设计影响了众多后来的编程语言，例如 C++、Objective-C、Java、C# 等。
二十世纪八十年代，为了避免各开发厂商用的C语言语法产生差异，由美国国家标准局为 C语言订定了一套完整的国际标准语法，称为 ANSI C，作为C语言的标准。二十世纪八十年代至今的有关程序开发工具，一般都支持匹配 ANSI C 的语法。

### C的缺陷

由于以上的原因，C语言具有众多优点，比如语言简洁灵活，程序执行效率高，程序结构清晰，易于阅读、测试、排错和修改，同时具有高级语言和汇编语言的优点等。与其他高级语言相比，C语言可以直接访问物理地址；与汇编语言相比，它又具有良好的可读性和可移植性，因而，C语言广泛用于系统软件与应用软件的开发。

随着软件规模的增大，用C语言编写程序渐渐变得有些困难。这不能不引起人们的思考。人们在反思、总结面向过程的结构化程序设计方法学时，发现该方法学存在着明显的问题——这种方法以算法为核心，把数据和过程作为相互独立的部分，数据代表问题空间中的客体，程序代码则用于处理这些数据。把数据和代码作为分离的实体很好地反映了计算机的特点，因为在计算机内部，数据和程序是分开存放的，但是，这样做的时候总存在使用错误的数据调用正确的程序模块，或使用正确的数据调用错误的程序模块的危险。让数据和操作保持一致是程序员的一个沉重负担。在多人分工合作开发一个大型软件系统的过程中，如果负责设计数据结构的人中途改变了某个数据的结构而又没有及时通知所有人员，则会发生许多不该发生的错误。更关键的是，该方法学忽略了数据和操作之间的内在联系，用这种方法所设计出来的软件系统其解空间（计算机世界）与问题空间（客观世界）并不一致，令人感到难于理解。

## C++

### 早期发展

由于C语言的这一问题，人们对客观世界重新进行了审视，得到了新的认知——面向对象方法学。如今，面向对象方法已经成为人们在开发软件时首选的方法，面向对象技术也已成为当前最好的软件开发技术。

AT&T Bell实验室的Bjarne Stroustrup博士及其同事于20世纪80年代初在C语言的基础上成功开发了C++｡ Stroustrup经过钻研在C语言中加入类的概念，因此，C++最初的名字是C with Class（「包含类的C语言」）。随后，C++不断增加新特性。虚函数（virtual function）、操作符重载（operator overloading）、多重继承（multiple inheritance）、模板（template）、异常处理（exception）、RTTI（Runtime type information）、命名空间（namespace）等逐渐纳入标准。到1983年12月由Rick Mascitti建议改名为 C Plus Plus，即C++。1998年，国际标准组织（ISO）颁布了C++程序设计语言的第一个国际标准ISO/IEC 14882:1998，目前最新标准为ISO/IEC 14882:2017。

首先提出类的概念的语言是 Simula，它具有很高的灵活性，但无法胜任比较大型的程序。此后在 Simula 语言基础上发展的 Smalltalk 语言才是真正的面向对象语言，但 Smalltalk-80 不支持多继承。C++ 从Simula继承了类的概念，从Algol68继承了运算符重载、引用，以及在任何地方声明变量的功能，从BCPL获得了用`//`注释，从Ada得到了模板、命名空间，从Ada、Clu 和 ML 得到了异常处理。

C++是由C语言这一强大的基础上发展而来，因而与C兼容，且保留了C语言强大的软硬件控制功能，同时又融入了面向对象的编程思想，强调程序的分层、分类，以抽象的类为基础，进行对象的定义与展示，使应用程序具有封装性、继承性和多态性。从C++的名字可以看出它是C的超越和集中。C++既可用于面向过程的结构化程序设计，又可用于面向对象的程序设计，是一种功能强大的混合型的程序设计语言。

### 面向对象

面向对象程序设计的出发点和基本原则是尽可能模拟人类习惯的思维方式，使开发软件的方法与过程尽可能接近人类认识客观世界、解决实际问题的方法与过程，也就是使描述问题的问题空间（也称为问题域）与实现解法的解空间（也称为求解域）在结构上尽可能一致。面向对象方法学的基本原理是，使用现实世界的概念抽象地思考问题从而自然地解决问题。它强调模拟现实世界中的概念而不强调算法，鼓励开发者在软件开发的绝大部分过程中都用应用领域的概念去思考。面向对象的软件开发过程从始至终都围绕着建立问题领域的对象模型来进行：对问题领域进行自然的分解，确定需要使用的对象和类，建立适当的类等级，在对象之间传递消息实现必要的联系，从而按照人们习惯的思维方式建立起问题领域的模型，模拟客观世界。面向对象方法学达到了软件工程的三个主要目标，即重用性、灵活性和扩展性。

面向对象程序的主要结构特点有两个：一个是程序一般由类的定义和类的使用两部分组成，在主程序中定义各对象并规定它们之间传递消息的规律；另一个是程序中的一切操作都是通过面向对象发送消息来实现的，对象接收到消息后，启动有关方法完成相应的操作。
面向对象设计的最大优点就是软件具有可重用性。当人们对软件系统的要求有所改变时，不需要程序员做大量的工作就能使系统做相应的变化。

### 与C的联系

顾名思义，C++是以C语言为基础增加一些新内容发展而来，C++是C语言的推广和延伸，绝大部分C语言中正确的语句在C++中也可以使用。在介绍C++与C语言的渊源时,人们也总爱利用“超集”与“子集”两个字眼。就其产生历史而言，1972年贝尔实验室设计出C语言，随着面向对象技术的发展，1983贝尔实验室设计了C++，在C语言的基础上增加了面向对象的程序设计功能。

C++与C语言中都有**`main`函数**，其在两种语言中都起着不可或缺的作用，而且担当着重要的作用，即程序的入口。

**类（`class`）**是面向对象程序设计中的最基本的概念，是实现面向对象程序设计的基础与核心。类是将不同类型的数据和与这些数据相关的操作封装在一起的集合体，是对要处理问题的抽象描述。定义了抽象类之后可利用该类定义其实体即该类的对象。结构体（`struct`）是C语言中很有用的一种数据类型，结构体成员组合在一起形成一个整体，其成员可以是不同的类型。定义结构体之后可用该结构体类型定义其实体即结构体变量。C语言中的结构可以说是C++中的类的雏形，但其区别也是显而易见的，结构体只是相同或不间类型的数据成员的集合，没有成员函数；结构体中也没有`public`和`private`关键字，其中的数据成员默认都是公有的，一般函数都可以访问，而C++的类中的数据成员默认情况下都是私有的，只有类对象中的成员函数和友元函数能够访问，这样极大地提高了数据的安全性。

**模板**是C++程序设计中的重要机制，可以节约程序代码，提高面向对象程序设计的可重用性和可维护性。模板把函数或类要处理的数据类型参数化，表现为参数的多态性，从而有效地实现了程序设计中的代码重用。而C语言中的宏定义是一种预处理方式，可以改进程序设计环境，提高编程效率。其中带参数的宏定义方式不只是简单的字符串替换，还会进行参数替换，这可以说是面向对象程序设计中的函数模板的基础。

### 与C的主要区别

C++与C语言最大的区别在于编程思想的截然不同，前者是面向对象(OOP)的编程语言，而后者则是面向过程的结构化的编程语言。尽管二者都是为了解决问题或开发系统、应用程序的工具，但面向对象的程序语言将程序设计的思维变得更加接近人类的思考方式，从而使得计算机也变得更加人性化。

之所以说C++比C更先进，是因为「设计」这个概念已经被融入到C++之中，而就语言本身而言，在C中更多的是算法的概念，但是C是C++的子集。从上文可以看出，C实现了C++中过程化控制及其他相关功能，而在C++中的C，相对于原来的C还有所加强，引入了重载、内联函数、异常处理等概念，C++更是拓展了面向对象设计的内容，如类、继承、虚函数、模板和包容器类等。再深入一点，在C++中，除了考虑数据封装、类型问题以外，还需要考虑诸如对象粒度的选择、对象接口的设计和继承、组合与继承的使用等问题。所以相对于C， C++包含了更丰富的「设计」的概念。

C++和C的设计哲学并不一样，两者取舍不同，所以不同的程序员和软件项目会有不同选择，难以一概而论。与C++相比，C具备编译速度快、容易学习、显式描述程序细节、较少更新标准等优点，后两者也可同时视为缺点。在语言层面上，C++包含绝大部分C语言的功能(例外之一，C++没有C99的变长数组VLA)，且提供面向对象程序设计（OOP）和类属编程（GP）的特性。但其实用C也可实现面向对象程序设计的思想，亦可利用宏去实现某程度的类属编程，只不过C++的语法能较简洁、自动地实现面向对象程序设计和类属编程。

## 参考资料

[1] C++ primer plus 第6版

[2] 维基百科

[3] 计算思维——计算学科导论
